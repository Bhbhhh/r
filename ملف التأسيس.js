// 1๏ธโฃ ูุนุฑู ุงูุณุจุฑูุฏุดูุช (ุงุฎุชูุงุฑู ููู ููุถู ุงุณุชุฎุฏุงูู ูุถูุงู ุงูุฑุจุท ุงูุตุญูุญ)
var MASTER_SS_ID = "13eONR-nL_hZniACgBdlrzXFprNgZwuGUkyrey-n7VrA";



/**
 * ุฏุงูุฉ ููุญุฏุฉ ููุญุตูู ุนูู ููู ุงูุณุจุฑูุฏุดูุช
 * ุชุญุงูู ุฌูุจ ุงูููู ุงููุดุท ุฃููุงูุ ูุฅุฐุง ูุดูุช ุชุณุชุฎุฏู ุงููุนุฑู ุงูุซุงุจุช
 */
function getSS() {
  try {
    return SpreadsheetApp.getActiveSpreadsheet() || SpreadsheetApp.openById(MASTER_SS_ID);
  } catch (e) {
    return SpreadsheetApp.openById(MASTER_SS_ID);
  }
}

/**
 * ุฏุงูุฉ ุชุฃุณูุณ ุงููุธุงู ุงูุดุงููุฉ
 */


function setupFullSystem() {
  var ss = getSS();
  var finalReport = [];
  // ุงููุงุฆูุฉ ุงููุงููุฉ ููุฌุฏุงูู ูุฃุนูุฏุชูุง ุจุงูุชุฑุชูุจ ุงูุตุญูุญ
  var tables = [
    { name: "ุงูุฅุนุฏุงุฏุงุช", cols: ["ุงูุนููุงู", "ุงููููุฉ", "ููุงุญุธุงุช"] },
    { name: "ุฅุฏุงุฑุฉ_ุงููุฑูุน", cols: ["ูุนุฑู_ุงููุฑุน", "ุงุณู_ุงููุฑุน", "ุงูุฏููุฉ", "ุงููุฏูุฑ_ุงููุณุคูู", "ุงูุนููุฉ", "ููุงุญุธุงุช"] },
    { name: "ุงููููู_ุงูุชูุธููู_ูุงูุตูุงุญูุงุช", cols: ["ูุนุฑู_ุงูุฏูุฑ", "ุงููุณูู_ุงููุธููู", "ูุณุชูู_ุงูุตูุงุญูุฉ", "ุงูููุงู"] },
    { name: "ูุงุนุฏุฉ_ุจูุงูุงุช_ุงูุทูุงุจ", cols: ["ูุนุฑู_ุงูุทุงูุจ", "ุงูุงุณู_ุจุงูุฅูุฌููุฒู", "ุงูุงุณู_ุจุงูุนุฑุจู", "ุงูุนูุฑ", "ุงูุจูุฏ", "ุฑูู_ุงููุงุชู", "ุงูุจุฑูุฏ_ุงูุฅููุชุฑููู", "ุชุงุฑูุฎ_ุงูุชุณุฌูู", "ุชุงุฑูุฎ_ุงููููุงุฏ", "ุงููุณุชูู", "ุงูุญุงูุฉ", "ูููุฉ_ุงููุฑูุฑ", "ุฑุงุจุท_ุงูุตูุฑุฉ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ููุงุญุธุงุช", "ุงูุฌูุณ", "ุงุณู_ููู_ุงูุฃูุฑ", "ุฑูู_ุชูุงุตู_ููู_ุงูุฃูุฑ", "ูุบุฉ_ุงูุฏุฑุงุณุฉ_ุงูููุถูุฉ", "ููุฏ_ุงูุฎุตู", "ูุตุฏุฑ_ุงูุชุณุฌูู", "ุขุฎุฑ_ูุดุงุท", "ุงูุญุงูุฉ_ุงูุตุญูุฉ", "ุฑุงุจุท_ููู_ุงููููุฉ"] },
    { name: "ุฅุฏุงุฑุฉ_ุงููุนูููู_ูุงูููุธููู", cols: ["ูุนุฑู_ุงูููุธู", "ุงูุงุณู_ุงููุงูู", "ุงูุชุฎุตุต", "ุฑูู_ุงููุงุชู", "ุงูุจุฑูุฏ_ุงูุฅููุชุฑููู", "ุชุงุฑูุฎ_ุงูุชุนููู", "ุงูุฑุงุชุจ_ุงูุฃุณุงุณู", "ูุณุจุฉ_ุงูุญูุงูุฒ", "ุงูุญุงูุฉ_ุงููุธูููุฉ", "ูุนุฑู_ุงููุฑุน"] },
    { name: "ุงูุฏูุฑุงุช_ุงูุชุฏุฑูุจูุฉ", cols: ["ูุนุฑู_ุงูุฏูุฑุฉ", "ุงุณู_ุงูุฏูุฑุฉ", "ุนุฏุฏ_ุงูุณุงุนุงุช", "ุชุงุฑูุฎ_ุงูุจุฏุงูุฉ", "ุชุงุฑูุฎ_ุงูููุงูุฉ", "ููุน_ุงูุฏูุฑุฉ", "ุณุนุฑ_ุงูุฏูุฑุฉ", "ุงูุญุฏ_ุงูุฃูุตู", "ุงููุชุทูุจุงุช"] },
    { name: "ุงูููุงุฏ_ุงูุฏุฑุงุณูุฉ", cols: ["ูุนุฑู_ุงููุงุฏุฉ", "ุงุณู_ุงููุงุฏุฉ", "ุงููุตู", "ุนุฏุฏ_ุงููุญุฏุงุช", "ูุนุฑู_ุงูุฏูุฑุฉ"] },
    { name: "ุงููุณุชููุงุช_ุงูุฃูุงุฏูููุฉ", cols: ["ูุนุฑู_ุงููุณุชูู", "ุงุณู_ุงููุณุชูู", "ุงููุชุทูุจุงุช_ุงูุฏุฑุงุณูุฉ", "ุชุฑุชูุจ_ุงููุณุชูู"] },
    { name: "ุฅุฏุงุฑุฉ_ุงููุฌููุนุงุช", cols: ["ูุนุฑู_ุงููุฌููุนุฉ", "ุงุณู_ุงููุฌููุนุฉ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ุฃูุงู_ุงูุฏุฑุงุณุฉ", "ุชูููุช_ุงูุฏุฑุงุณุฉ", "ุงููุนูู_ุงููุณุคูู", "ุญุงูุฉ_ุงููุฌููุนุฉ"] },
    { name: "ุฌุฏูู_ุงูุญุตุต", cols: ["ุงูุชุงุฑูุฎ", "ุงูููู", "ููุช_ุงูุจุฏุงูุฉ", "ููุช_ุงูููุงูุฉ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ูุนุฑู_ุงููุฌููุนุฉ", "ุงููุนูู", "ุงูุญุงูุฉ", "ููุงุญุธุงุช", "ููุน_ุงูุญุตุฉ", "ุฑุงุจุท_ุงูุญุตุฉ", "ุชูุจูู_ุชููุงุฆู"] },
    { name: "ุณุฌู_ุงูุญุถูุฑ", cols: ["ุงูุชุงุฑูุฎ", "ููุช_ุงูุญุถูุฑ", "ููุช_ุงูุงูุตุฑุงู", "ูุนุฑู_ุงูุทุงูุจ", "ุงุณู_ุงูุทุงูุจ", "ููุน_ุงูุญุถูุฑ", "ุงูุญุงูุฉ", "ุฅุฌูุงูู_ุงูุญุถูุฑ", "ุฅุฌูุงูู_ุงูุบูุงุจ", "ุณุจุจ_ุงูุบูุงุจ"] },
    { name: "ุงูุชูุงุฑูุฑ_ุงูููููุฉ", cols: ["ุงูุชุงุฑูุฎ_ูุงูููุช", "ุงูุดูุฑ", "ูุนุฑู_ุงูุทุงูุจ", "ุงุณู_ุงูุทุงูุจ", "ุงูุญูุธ_ุงูุฌุฏูุฏ", "ุงูุฃุฎุทุงุก", "ุงููุฑุงุฌุนุฉ", "ุงูุชูููู", "ูุงุฌุจ_ุงูุชุฌููุฏ", "ูุฏุฉ_ุงูุญูุธ", "ุฏุฑุฌุฉ_ุงูุชุฌููุฏ", "ููุน_ุงูุญูุธ", "ูุคุดุฑ_ุงูุฃุฏุงุก", "ุชุณุฌูู_ุตูุชู"] },
    { name: "ูุชุงุจุนุฉ_ุงูุชูุฏู", cols: ["ูุนุฑู_ุงูุทุงูุจ", "ุงุณู_ุงูุทุงูุจ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ุงูุชูุฏู_ุงูุญุงูู", "ุงูุฃุฎุทุงุก_ุงููุชูุฑุฑุฉ", "ูุณุจุฉ_ุงูุฅูุฌุงุฒ", "ูุณุชูู_ุงูุชุฌููุฏ", "ุฃูุงู_ุงูุญุถูุฑ", "ุชุงุฑูุฎ_ุงูุชูุจูู"] },
    { name: "ุจูู_ุงูุฃุณุฆูุฉ", cols: ["ูุนุฑู_ุงูุณุคุงู","ูุต_ุงูุณุคุงู","ุงูุฎูุงุฑ_A","ุงูุฎูุงุฑ_B","ุงูุฎูุงุฑ_C","ุงูุฅุฌุงุจุฉ_ุงูุตุญูุญุฉ","ุงูุฏุฑุฌุฉ","ูุฏุฉ_ุงูุณุคุงู_ุจุงูุซูุงูู","ูุนุฑู_ุงูุฏูุฑุฉ","ูุณุชูู_ุงูุตุนูุจุฉ","ููุน_ุงูุณุคุงู","ุดุฑุญ_ุงูุฅุฌุงุจุฉ","ุญุงูุฉ_ุงูุณุคุงู","ุชุงุฑูุฎ_ุงูุฅุถุงูุฉ","ูููุดุฆ_ุงูุณุคุงู"] },
    { name: "ุจูู_ุงูุงุฎุชุจุงุฑุงุช_ุงูุขููุฉ", cols: ["ูุนุฑู_ุงูุงุฎุชุจุงุฑ","ุงุณู_ุงูุงุฎุชุจุงุฑ","ูุนุฑู_ุงูุฏูุฑุฉ","ูุงุฆูุฉ_ุงูุฃุณุฆูุฉ","ุนุฏุฏ_ุงูุฃุณุฆูุฉ","ุฏุฑุฌุฉ_ุงููุฌุงุญ","ูุฏุฉ_ุงูุงุฎุชุจุงุฑ","ุทุฑููุฉ_ุญุณุงุจ_ุงูููุช","ุชุฑุชูุจ_ุนุดูุงุฆู","ูุญุงููุงุช_ูุณููุญุฉ","ุญุงูุฉ_ุงูุงุฎุชุจุงุฑ","ุชุงุฑูุฎ_ุงูุฅูุดุงุก"] },
    { name: "ุณุฌู_ุงูุฅุฌุงุจุงุช", cols: ["ูุนุฑู_ุงูุทุงูุจ","ุงุณู_ุงูุทุงูุจ","ูุนุฑู_ุงูุงุฎุชุจุงุฑ","ุงุณู_ุงูุงุฎุชุจุงุฑ","ุงูุฏุฑุฌุฉ","ุงููุณุจุฉ_ุงููุฆููุฉ","ุนุฏุฏ_ุงูุฃุณุฆูุฉ","ุนุฏุฏ_ุงูุฅุฌุงุจุงุช_ุงูุตุญูุญุฉ","ุนุฏุฏ_ุงูุฅุฌุงุจุงุช_ุงูุฎุงุทุฆุฉ","ุญุงูุฉ_ุงููุฌุงุญ","ุชุงุฑูุฎ_ุงูุงุฎุชุจุงุฑ","ุงูุฑูู_ุงูุชุณูุณูู","ุฑุงุจุท_ุงูุดูุงุฏุฉ","ุชูุงุตูู_ุงูุฅุฌุงุจุงุช"] },
    { name: "ุงูุดูุงุฏุงุช_ุงูุตุงุฏุฑุฉ", cols: ["ุฑูู_ุงูุดูุงุฏุฉ","ูุนุฑู_ุงูุทุงูุจ","ุงุณู_ุงูุทุงูุจ_ุนุฑุจู","ุงุณู_ุงูุทุงูุจ_ุงูุฌููุฒู","ูุนุฑู_ุงูุฏูุฑุฉ","ุงุณู_ุงูุฏูุฑุฉ","ุชุงุฑูุฎ_ุจุฏุก_ุงูุฏูุฑุฉ","ุชุงุฑูุฎ_ุงูุชูุงุก_ุงูุฏูุฑุฉ","ุชุงุฑูุฎ_ุงูุฅุตุฏุงุฑ","ูุณุจุฉ_ุงููุฌุงุญ","ุงูุชูุฏูุฑ_ุงูุนุงู","ุฑุงุจุท_ุงูุดูุงุฏุฉ","ููุน_ุงูุดูุงุฏุฉ","ุงูุญุงูุฉ","ุฑูู_ุงูุชุญูู","ุงูุฌูุฉ_ุงููุตุฏุฑุฉ","ููุงุญุธุงุช","ุชุงุฑูุฎ_ุงูุฅูุบุงุก","ุณุจุจ_ุงูุฅูุบุงุก"] },
    { name: "ุงูุฅุฏุงุฑุฉ_ุงููุงููุฉ_ููุทูุงุจ", cols: ["ูุนุฑู_ุงูุฏูุน", "ูุนุฑู_ุงูุทุงูุจ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ุงููุจูุบ_ุงููุฏููุน", "ุงููุจูุบ_ุงูุฅุฌูุงูู", "ุชุงุฑูุฎ_ุงูุฏูุน", "ุทุฑููุฉ_ุงูุฏูุน", "ุฑุงุจุท_ุงูุฅูุตุงู", "ุญุงูุฉ_ุงูุณุฏุงุฏ"] },
    { name: "ุณุฌู_ุณุงุนุงุช_ุงูุนูู", cols: ["ูุนุฑู_ุงูููุธู", "ุงูุชุงุฑูุฎ", "ุนุฏุฏ_ุงูุณุงุนุงุช", "ููุน_ุงููุดุงุท", "ููุงุญุธุงุช"] },
    { name: "ูุดูู_ุงููุฑุชุจุงุช", cols: ["ุงูุดูุฑ", "ูุนุฑู_ุงูููุธู", "ุงูุฑุงุชุจ_ุงูุฃุณุงุณู", "ุงูุญูุงูุฒ", "ุงูุฎุตููุงุช", "ุตุงูู_ุงูุฑุงุชุจ", "ุญุงูุฉ_ุงูุตุฑู"] },
    { name: "ุฅุฏุงุฑุฉ_ุงูุญููุงุช_ุงูุฅุนูุงููุฉ", cols: ["ูุนุฑู_ุงูุญููุฉ", "ุงูููุตุฉ", "ุชุงุฑูุฎ_ุงูุจุฏุงูุฉ", "ุงูููุฒุงููุฉ", "ุนุฏุฏ_ุงููุณุฌููู", "ุงูุญุงูุฉ"] },
    { name: "ุงูุฅุนูุงูุงุช", cols: ["ูุนุฑู_ุงูุฅุนูุงู", "ุงูุชุงุฑูุฎ", "ุงูุนููุงู", "ุงููุญุชูู", "ุงูุญุงูุฉ", "ุงูููุน", "ุงูููุตุฉ", "ูุนุฑู_ุงูุญููุฉ", "ุชุงุฑูุฎ_ุงููุดุฑ", "ุชุงุฑูุฎ_ุงูุงูุชูุงุก", "ุนุฏุฏ_ุงููุดุงูุฏุงุช", "ุนุฏุฏ_ุงูุชูุงุนูุงุช", "ุฃูุดุฆ_ุจูุงุณุทุฉ", "ุขุฎุฑ_ุชุนุฏูู", "ููุงุญุธุงุช"] },
    { name: "ุณุฌู_ุงูุทูุงุจ_ุงููุญุชูููู", cols: ["ุงูุงุณู", "ุฑูู_ุงููุงุชู", "ุงูุจุฑูุฏ", "ุงููุงุฏุฉ_ุงูููุชู_ุจูุง", "ุญุงูุฉ_ุงููุชุงุจุนุฉ", "ุชุงุฑูุฎ_ุขุฎุฑ_ุชูุงุตู"] },
    { name: "ุงูุฏุนู_ุงูููู_ูุงูุดูุงูู", cols: ["ุฑูู_ุงูุชุฐูุฑุฉ", "ูุนุฑู_ุงูุทุงูุจ", "ุงูููุถูุน", "ุงูุฑุณุงูุฉ", "ุงูุฃููููุฉ", "ุงูุญุงูุฉ", "ุฑุฏ_ุงูุฅุฏุงุฑุฉ"] },
    { name: "ุงุณุชุทูุงุนุงุช_ุงูุฑุฃู_ูุงูุฌูุฏุฉ", cols: ["ุงูุชุงุฑูุฎ", "ูุนุฑู_ุงูุทุงูุจ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ุชูููู_ุงููุนูู", "ุชูููู_ุงููุญุชูู", "ููุชุฑุญุงุช_ููุชุญุณูู"] },
    { name: "ุงููุตุงุฏุฑ_ูุงููููุงุช", cols: ["ูุนุฑู_ุงููุตุฏุฑ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ุงูุนููุงู", "ููุน_ุงูููู", "ุฑุงุจุท_ุงูููู", "ูู_ูุชุงุญ_ููุทุงูุจ"] },
    { name: "ุงูุนููุฏ_ูุงูุงุชูุงููุงุช", cols: ["ุฑูู_ุงูุนูุฏ", "ุงูุทุฑู_ุงูุซุงูู", "ููุน_ุงูุนูุฏ", "ุชุงุฑูุฎ_ุงูุจุฏุงูุฉ", "ุชุงุฑูุฎ_ุงูููุงูุฉ", "ุฑุงุจุท_ุงูุนูุฏ"] },
    { name: "ูุธุงู_ุงูุฅุดุนุงุฑุงุช", cols: ["ูุนุฑู_ุงูุทุงูุจ", "ููุน_ุงูุฅุดุนุงุฑ", "ุงูุชุงุฑูุฎ_ูุงูููุช", "ุงูุญุงูุฉ", "ููุงุญุธุงุช"] },
    { name: "ุณุฌู_ุงูุจุฑูุฏ", cols: ["ุงูุชุงุฑูุฎ_ูุงูููุช", "ุฅูู", "ุงูููุถูุน", "ุงูุญุงูุฉ"] },
    { name: "ุณุฌู_ุงูุนูููุงุช_ุงูุฅุฏุงุฑูุฉ", cols: ["ุงูุชุงุฑูุฎ_ูุงูููุช", "ุจุฑูุฏ_ุงููุณุคูู", "ุงูุฅุฌุฑุงุก", "ุงูุชูุงุตูู"] },
    { name: "ุณุฌู_ุฃุฎุทุงุก_ุงููุธุงู", cols: ["ุงูุชุงุฑูุฎ_ูุงูููุช", "ูุตู_ุงูุฎุทุฃ", "ุงูุจูุงูุงุช_ุงููุณุจุจุฉ"] },
    { name: "ุฌูุณุงุช_ุงูุฏุฎูู", cols: ["ุฑูุฒ_ุงูุฌูุณุฉ", "ูุนุฑู_ุงููุณุชุฎุฏู", "ููุน_ุงููุณุชุฎุฏู", "ููุช_ุชุณุฌูู_ุงูุฏุฎูู", "ุงูุญุงูุฉ"] },
    { name: "ุงูููุงู_ุงูุฅุฏุงุฑูุฉ", cols: ["ูุนุฑู_ุงููููุฉ", "ุนููุงู_ุงููููุฉ", "ุงููุตู", "ุงูููุธู_ุงููุณุคูู", "ุชุงุฑูุฎ_ุงูุฅุณูุงุฏ", "ุงูููุนุฏ_ุงูููุงุฆู", "ุงูุญุงูุฉ", "ุงูุฃููููุฉ", "ุชุงุฑูุฎ_ุงูุฅุชูุงู", "ููุงุญุธุงุช_ุงููุชุงุจุนุฉ", "ุงููุฑููุงุช", "ููุน_ุงููููุฉ", "ุชุงุฑูุฎ_ุขุฎุฑ_ุชุญุฏูุซ", "ุญุงูุฉ_ุงูุชูุจูู"] },
    { name: "ุงูุทูุจุงุช", cols: ["ูุนุฑู_ุงูุทูุจ", "ุงูุชุงุฑูุฎ", "ูุนุฑู_ุงูุทุงูุจ", "ุงุณู_ุงูุทุงูุจ", "ููุน_ุงูุทูุจ", "ุงูุชูุงุตูู", "ุงูุฃููููุฉ", "ุงูุญุงูุฉ", "ุงูููุธู_ุงููุณุคูู", "ููุงุฉ_ุงูุทูุจ", "ุชุงุฑูุฎ_ุงูุฑุฏ", "ุชุงุฑูุฎ_ุงูุฅุบูุงู", "ูุฏุฉ_ุงููุนุงูุฌุฉ", "ููุงุญุธุงุช_ุงูุฅุฏุงุฑุฉ", "ูุฑููุงุช", "ุขุฎุฑ_ุชุญุฏูุซ"] },
    { name: "ุงูููุชุจุฉ", cols: ["ูุนุฑู_ุงูููู","ุงุณู_ุงูููู","ุงูููุน","ุงูุชุตููู","ุงูุฏูุฑุฉ","ุงููุตู","ุงูุฑุงุจุท","ุตูุงุญูุฉ_ุงููุตูู","ุณุนุฑ_ุงููุตูู","ุนุฏุฏ_ุงููุดุงูุฏุงุช","ุนุฏุฏ_ุงููุดุชุฑููู","ูุบุฉ_ุงููุญุชูู","ุงููุณุชูู","ูุฏุฉ_ุงููุญุงุถุฑุฉ","ุชุงุฑูุฎ_ุงูุฅุถุงูุฉ","ุชุงุฑูุฎ_ุขุฎุฑ_ุชุญุฏูุซ","ุฃุถูู_ุจูุงุณุทุฉ","ุงูุญุงูุฉ","ุณุฌู_ุงูุชุนุฏูู","ุนุฏุฏ_ุงูุชููููุงุช","ูุชูุณุท_ุงูุชูููู","ุชุนูููุงุช","ุนุฏุฏ_ุงููุดุงุฑูุงุช"] },
    { name: "ุงูุฃูุณูุฉ", cols: ["ูุนุฑู_ุงููุณุงู", "ูุนุฑู_ุงูุทุงูุจ", "ุงุณู_ุงููุณุงู", "ูุตู_ุงููุณุงู", "ุณุจุจ_ุงูููุญ", "ุชุงุฑูุฎ_ุงูููุญ", "ููุญ_ุจูุงุณุทุฉ", "ูุฑุฆู_ููุทุงูุจ", "ููุงุญุธุงุช"] },
    { name: "ุงูุฅูุฌุงุฒุงุช", cols: ["ูุนุฑู_ุงูุฅูุฌุงุฒ", "ูุนุฑู_ุงูุทุงูุจ", "ุงุณู_ุงูุทุงูุจ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ูุนุฑู_ุงููุฌููุนุฉ", "ููุน_ุงูุฅูุฌุงุฒ", "ูุตู_ุงูุฅูุฌุงุฒ", "ุงูุชุงุฑูุฎ", "ุงููุตุฏุฑ", "ุงููุณุชูู", "ุงูููุงุท", "ูุฑุฆู_ููุทุงูุจ", "ููุงุญุธุงุช", "ุชุงุฑูุฎ_ุขุฎุฑ_ุชุญุฏูุซ"] },
    { name: "ุงููุงุฌุจุงุช", cols: ["ูุนุฑู_ุงููุงุฌุจ", "ูุนุฑู_ุงูุฏูุฑุฉ", "ูุนุฑู_ุงููุฌููุนุฉ", "ุนููุงู_ุงููุงุฌุจ", "ูุตู_ุงููุงุฌุจ", "ุชุงุฑูุฎ_ุงูุฅุณูุงุฏ", "ุชุงุฑูุฎ_ุงูุชุณููู", "ุทุฑููุฉ_ุงูุชุณููู", "ุงูุญุงูุฉ", "ุฏุฑุฌุฉ_ูุงููุฉ", "ููุงุญุธุงุช_ุงููุนูู", "ูุฑููุงุช", "ุขุฎุฑ_ุชุญุฏูุซ"] },
    { name: "ุงูุจุฑูุฏ_ุงูุฏุงุฎูู", cols: ["ูุนุฑู_ุงูุฑุณุงูุฉ", "ูุนุฑู_ุงููุญุงุฏุซุฉ", "ุฑุฏ_ุนูู", "ููุน_ุงูุฑุณุงูุฉ", "ุงููุฑุณู", "ููุน_ุงููุฑุณู", "ูุนุฑู_ุงูุทุงูุจ", "ุงููุณุชูู", "ููุน_ุงููุณุชูู", "ุงูุนููุงู", "ุงููุญุชูู", "ุงูุญุงูุฉ", "ุงูุฃููููุฉ", "ููุงุฉ_ุงูุฅุฑุณุงู", "ุนุฏุฏ_ุงููุฑููุงุช", "ูุฑููุงุช", "ูุนุฑู_ุงูููุงู_ุงููุฑุชุจุท", "ููู", "IP_ุงููุฑุณู", "ุชู_ุงูุฅุดุนุงุฑ", "ุนุฏุฏ_ุงูุฑุฏูุฏ", "ูุฑุฆู_ูููุฏุฑุณูู", "ุชุตููู_ุงูุฑุณุงูุฉ", "ุชุงุฑูุฎ_ุงูุฅุฑุณุงู", "ุชุงุฑูุฎ_ุงููุฑุงุกุฉ", "ุชุงุฑูุฎ_ุงููุฑุงุฌุนุฉ", "ุชุงุฑูุฎ_ุงูุญุฐู", "ุชุงุฑูุฎ_ุขุฎุฑ_ุชุญุฏูุซ"] },
    { name: "ููุงูุจ_ุงูุจุฑูุฏ", cols: ["ูุนุฑู_ุงููุงูุจ", "ุฑูุฒ_ุงููุงูุจ", "ุงุณู_ุงููุงูุจ", "ุงููุตู", "ููุน_ุงููุงูุจ", "ุญุฏุซ_ุงูุชุดุบูู", "ูุบุฉ_ุงููุงูุจ", "ุงูุนููุงู", "ุงููุญุชูู", "ูุชุบูุฑุงุช_ุงููุงูุจ", "ูุงุจู_ููุชุนุฏูู", "ุงูุญุงูุฉ", "ุนุฏุฏ_ูุฑุงุช_ุงูุงุณุชุฎุฏุงู", "ุขุฎุฑ_ุงุณุชุฎุฏุงู", "ุฃูุดุฆ_ุจูุงุณุทุฉ", "ุชุงุฑูุฎ_ุงูุฅูุดุงุก", "ุขุฎุฑ_ุชุญุฏูุซ", "ููุงุญุธุงุช_ุชูููุฉ"] },
    { name: "ุงููุฎุงุฒู_ูุงูุชุฌููุฒุงุช", cols: ["ูุนุฑู_ุงููุฎุฒู","ุงุณู_ุงููุฎุฒู","ููุน_ุงููุฎุฒู","ุนููุงู_ุงููุฎุฒู","ุฃููู_ุงููุฎุฒู","ุฌูุฉ_ุงููุณุคูู","ุฑูู_ุงูุชูุงุตู","ููุน_ุงูุชุฌููุฒ","ูุนุฑู_ุงูุชุฌููุฒ","ุงุณู_ุงูุชุฌููุฒ","ุงููููุฉ_ุงููุชููุฑุฉ","ุงููุญุฏุฉ","ุงูุญุงูุฉ","ุชุงุฑูุฎ_ุงูุฅุฏุฎุงู","ุชุงุฑูุฎ_ุขุฎุฑ_ุชุญุฏูุซ","ุงูุฌูุฉ_ุงููุณุชุฎุฏูุฉ","ููุงู_ุงูุชุฎุฒูู_ุงููุฑุนู","ููุงุญุธุงุช","ุณุนุฑ_ุงููุญุฏุฉ","ุงูููุฑุฏ","ุชุงุฑูุฎ_ุงูุตูุงูุฉ_ุงูููุจูุฉ","ูุณุคูู_ุงูุตูุงูุฉ"] },
    { name: "ูููุงุช_ุงูุดุงุช", cols: ["ูุนุฑู_ุงูููุงุฉ", "ุงุณู_ุงูููุงุฉ", "ููุน_ุงูููุงุฉ", "ูุนุฑู_ุงููุงูู", "ูุตู_ุงูููุงุฉ", "ุชุงุฑูุฎ_ุงูุฅูุดุงุก", "ุขุฎุฑ_ุชุญุฏูุซ", "ุญุงูุฉ_ุงูููุงุฉ", "ูุณุชูู_ุงูุฎุตูุตูุฉ", "ุนุฏุฏ_ุงูุฃุนุถุงุก", "ุนุฏุฏ_ุงููุดุฑููู", "ุงููุณูู", "ุขุฎุฑ_ูุดุงุท", "ุตูุฑุฉ_ุงูููุงุฉ", "ููุฏ_ุงูุฏูุฑุฉ_ุงููุฑุชุจุทุฉ", "ุนุฏุฏ_ุงูุฑุณุงุฆู_ุบูุฑ_ุงูููุฑูุกุฉ"] },
    { name: "ุฑุณุงุฆู_ุงูุดุงุช", cols: ["ูุนุฑู_ุงูุฑุณุงูุฉ", "ูุนุฑู_ุงูููุงุฉ", "ุฑุฏ_ุนูู", "ุงููุฑุณู", "ููุน_ุงููุฑุณู", "ุงููุญุชูู", "ุนุฏุฏ_ุงููุฑููุงุช", "ุงููุฑููุงุช", "ููู", "IP_ุงููุฑุณู", "ูุฑุฆู_ูููุฏุฑุณูู", "ุชุงุฌุงุช_ุชุตููู", "ุชุงุฑูุฎ_ุงูุฅุฑุณุงู", "ุญุงูุฉ_ุงููุฑุงุกุฉ", "ูุฏุฉ_ุงูุฑุฏ", "ุขุฎุฑ_ุชุญุฏูุซ", "ุนุฏุฏ_ุงูุฑุฏูุฏ", "ูุบุฉ_ุงูุฑุณุงูุฉ", "ุณุฌู_ุงูุชุนุฏูู", "ุงูุฑุณุงุฆู_ุงููุซุจุชุฉ", "ุฑุฏูุฏ_ุงููุนู"] },
    { name: "ุฃุนุถุงุก_ุงููููุงุช", cols: ["ูุนุฑู_ุงูููุงุฉ", "ูุนุฑู_ุงูุนุถู", "ููุน_ุงูุนุถู", "ุตูุงุญูุงุช_ุงูุนุถู", "ุชุงุฑูุฎ_ุงูุงูุถูุงู", "ุชุงุฑูุฎ_ุงูุฎุฑูุฌ", "ุญุงูุฉ_ุงูุนุถู", "ููุงุญุธุงุช", "ููุชุงุญ_ุฑุจุท_ุงูุฏูุฑุงุช", "ุนุฏุฏ_ุงูุฑุณุงุฆู_ุบูุฑ_ุงูููุฑูุกุฉ", "ุขุฎุฑ_ูุดุงุท_ูู_ุงูููุงุฉ", "ููุงุญุธุงุช_ุงููุฏูุฑ"] },
    { name: "ุฃุนุถุงุก_ุงูุดุงุช", cols: ["ูุนุฑู_ุงูุนุถู", "ุงูุงุณู_ุงููุงูู", "ููุน_ุงูุนุถู", "ุงูุญุงูุฉ_ุงูุญุงููุฉ", "ุขุฎุฑ_ุชุณุฌูู_ุฏุฎูู", "ุขุฎุฑ_ูุดุงุท", "ุงูุจุฑูุฏ_ุงูุฅููุชุฑููู", "ุฑุงุจุท_ุงูุตูุฑุฉ", "ุงูุฑุชุจุฉ_ุฃู_ุงููุณุชูู", "ููุงุญุธุงุช", "ุชุงุฑูุฎ_ุฅูุดุงุก_ุงูุนุถู", "ุขุฎุฑ_ุชุญุฏูุซ", "ุญุงูุฉ_ุงูุญุธุฑ", "ุตูุงุญูุงุช_ุฅุฏุงุฑูุฉ", "ุฑูู_ุงููุงุชู", "ูุบุฉ_ููุถูุฉ", "ุชูุถููุงุช_ุงูุฅุดุนุงุฑุงุช"] },
    { name: "ุฅุดุนุงุฑุงุช_ุงูุดุงุช", cols: ["ูุนุฑู_ุงูุฅุดุนุงุฑ", "ููุน_ุงูุฅุดุนุงุฑ", "ุงููุณุชูู", "ููุน_ุงููุณุชูู", "ูุนุฑู_ุงูุนุถู_ุงููุฑุชุจุทุฉ_ุจู", "ูุนุฑู_ุงูููุงุฉ_ุฃู_ุงูุฑุณุงูุฉ", "ุงููุญุชูู", "ุชู_ุงูุชุนุงูู", "ุชุงุฑูุฎ_ุงูุฅุดุนุงุฑ", "ุขุฎุฑ_ุชุญุฏูุซ", "ุฑุงุจุท_ุงููุญุชูู"] },
    { name: "ูุฑููุงุช_ุงูุดุงุช", cols: ["ูุนุฑู_ุงููุฑูู", "ูุนุฑู_ุงูุฑุณุงูุฉ", "ุงุณู_ุงูููู", "ููุน_ุงููุฑูู", "ุญุฌู_ุงููุฑูู", "ุตูุงุญูุฉ_ุงููุตูู", "ุงูุฑุงุจุท", "ุชุงุฑูุฎ_ุงูุฅุถุงูุฉ", "ุฃุถูู_ุจูุงุณุทุฉ", "ุขุฎุฑ_ุชุญุฏูุซ", "ุญุงูุฉ_ุงููุฑูู", "ููุน_ุงููุตุฏุฑ"] },
    { name: "ุฅุญุตุงุฆูุงุช_ุงูุดุงุช", cols: ["ูุนุฑู_ุงูููุงุฉ", "ูุนุฑู_ุงูุนุถู", "ุนุฏุฏ_ุงูุฑุณุงุฆู_ุงููุฑุณูุฉ", "ุนุฏุฏ_ุงูุฑุฏูุฏ", "ูุนุฏู_ุงููุดุงุท_ุงููููู", "ุฃูุซุฑ_ุงูุฑุณุงุฆู_ุชูุงุนูุงู", "ุชุงุฑูุฎ_ุขุฎุฑ_ุชุญุฏูุซ", "ุนุฏุฏ_ุงูุฑุณุงุฆู_ุงูููุฑูุกุฉ", "ุนุฏุฏ_ุงูุฑุณุงุฆู_ุบูุฑ_ุงูููุฑูุกุฉ", "ุงููุนุฏู_ุงููุณูุท_ููุฑุฏูุฏ"] },
    { name: "ุณุฌู_ุฃุฎุทุงุก_ุดุงุช", cols: ["ุงูุชุงุฑูุฎ_ูุงูููุช", "ููุน_ุงูุฎุทุฃ", "ุงููุตุฏุฑ", "ุชูุงุตูู_ุงูุฎุทุฃ", "ุงูุญุงูุฉ"] },
    { name: "ุณุฌู_ูุดุงุทุงุช_ุดุงุช", cols: ["ุงูุชุงุฑูุฎ_ูุงูููุช", "ููุน_ุงููุดุงุท", "ุงููุณุชุฎุฏู_ุงููุณุคูู", "ุงููุญุชูู", "ุงููุตุฏุฑ", "ุงูุญุงูุฉ"] }
  ];


  // 2. ุงูููุฏ ููุฑ ุนูู ูู ุฌุฏูู ูููุญุตู ุชููุงุฆูุงู
  tables.forEach(function(table) {
    var result = createSheetIfNotExist(ss, table.name, table.cols);
    finalReport.push(table.name + ": " + result);
  });
  
  
  
    // ุฅุนุฏุงุฏ ุงูุฅุดุนุงุฑุงุช ูุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
  var settingsHeaders = ["ุงูุนููุงู", "ุงููููุฉ", "ููุงุญุธุงุช"];
  var settingsData = [
     ["API_KEY", "KANANT-2026", "ููุชุงุญ ุงูุฃูุงู ููุฑุจุท ูุน ุงูุชุทุจูู"],
  ["ACADEMY_NAME", "ุฃูุงุฏูููุฉ ูู ุฃูุช ููุชุฏุฑูุจ ูุงูุชุฃููู", "ุงูุงุณู ุงูุฑุณูู ููุฌูุฉ"],
  ["CURRENT_TERM", "ุงููุตู ุงูุฏุฑุงุณู ุงูุซุงูู", "ูุณุชุฎุฏู ูู ูุฑุฒ ุงููุชุงุฆุฌ"],
  ["MIN_PASS_GRADE", "60", "ุฏุฑุฌุฉ ุงููุฌุงุญ ุงูุฏููุง ูู ุงูุดูุงุฏุงุช"],
  ["ATTENDANCE_LIMIT", "15", "ููุช ุงูุณูุงุญ ุจุงูุชุฃุฎุฑ (ุจุงูุฏูุงุฆู)"],
  ["SYSTEM_LANGUAGE", "ar", "ูุบุฉ ุงููุธุงู ุงูุงูุชุฑุงุถูุฉ"],
  ["DATE_FORMAT", "yyyy-MM-dd HH:mm", "ุชูุณูู ุงูุชุงุฑูุฎ ุงูููุญุฏ ูู ุงููุธุงู"],
  ["TIME_FORMAT", "HH:mm", "ุตูุบุฉ ุนุฑุถ ุงูููุช (HH:mm)"],
  ["LOW_EVALUATION_LIMIT", "5", "ุงูุญุฏ ุงูุฃุฏูู ููุชูููู ูุจู ุฅูุดุงุก ุฅุดุนุงุฑ"],

  // ๐ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช
  ["NOTIFICATIONS_STATUS", "ูุดุท", "ุชุดุบูู ุฃู ุฅููุงู ูุธุงู ุงูุฅุดุนุงุฑุงุช"],
  ["DEFAULT_NOTIFICATION_CHANNEL", "internal", "ุงูููุงุฉ ุงูุงูุชุฑุงุถูุฉ ููุฅุดุนุงุฑุงุช"],
  ["NOTIFICATION_EXPIRY_DAYS", "30", "ุนุฏุฏ ุงูุฃูุงู ูุจู ุฃุฑุดูุฉ ุงูุฅุดุนุงุฑ ุชููุงุฆูุงู"],
  ["Notification_Sound", "true", "ุชุดุบูู ุตูุช ุงูุชูุจูู ููุฅุดุนุงุฑุงุช"],
  ["Notification_Priority", "High", "ุฏุฑุฌุฉ ุฃููููุฉ ุงูุฅุดุนุงุฑุงุช (High/Medium/Low)"],

  // ๐ง ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
  ["SYSTEM_ADMIN", "be.you.t2025@gmail.com", "ุจุฑูุฏ ูุณุคูู ุงููุธุงู"],
  ["EMAIL_API_KEY", "XYZ-1234-TEST", "ููุชุงุญ API ูุฎุฏูุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"],
  ["EMAIL_SIGNATURE", "ุฃูุงุฏูููุฉ ูู ุฃูุช ููุชุฏุฑูุจ ูุงูุชุฃููู", "ุชูููุน ุงูุฑุณุงุฆู ูุงูุฅุดุนุงุฑุงุช"],
  ["EMAIL_TEMPLATE_ATTENDANCE", "template_att_01", "ูุงูุจ ุฑุณุงุฆู ุงูุญุถูุฑ ูุงูุบูุงุจ"],
  ["EMAIL_TEMPLATE_NOTIFICATION", "template_notif_01", "ูุงูุจ ุฑุณุงุฆู ุงูุฅุดุนุงุฑุงุช ุงูุนุงูุฉ"],
  ["SEND_INDIVIDUAL", "true", "ุฅุฑุณุงู ุงูุจุฑูุฏ ูุฑุฏู (true) ุฃู ุฌูุงุนู (false)"],

  // โ๏ธ ุงููุธุงู ูุงูุชุดุบูู
  ["TEST_MODE", "false", "ูุถุน ุงูุงุฎุชุจุงุฑ (true = ุจุฏูู ุฅุฑุณุงู ูุนูู)"],
  ["SYSTEM_STATUS", "ูุดุท", "ุฅููุงู ุงููุธุงู ูุคูุชุงู ูุฃุนูุงู ุงูุตูุงูุฉ"],
  ["DEFAULT_SHEET", "MasterData", "ุงููุฑูุฉ ุงูุงูุชุฑุงุถูุฉ ููุจูุงูุงุช"],
  ["Backup_Enabled", "true", "ูุณุฎ ุงุญุชูุงุทู ุชููุงุฆู ููุจูุงูุงุช"],
  ["Auto_Archive", "true", "ุฃุฑุดูุฉ ุชููุงุฆูุฉ ููุจูุงูุงุช"],

  // ๐ ุงูุญุถูุฑ ูุงูุบูุงุจ
  ["ACADEMY_LOGO", "https://drive.google.com/file/d/1136iAKx_Y2GLc45zBx1q09-rMWX4rXI9/view?usp=drivesdk", "ุดุนุงุฑ ุงููุคุณุณุฉ"],
  ["PLATFORM_URL", "https://kanantacademy.com", "ุฑุงุจุท ุงูููุตุฉ ุงูุฅููุชุฑูููุฉ"],
  ["ABSENCE_ALERT_LIMIT", "5", "ุงูุบูุงุจ ุงููุณููุญ ุจู ูุจู ุฅุฑุณุงู ุฅุดุนุงุฑ"],
  ["Attendance_Sheet", "AttendanceLog", "ุงุณู ูุฑูุฉ ุณุฌู ุงูุญุถูุฑ"],
  ["Auto_Calc_Attendance", "true", "ุญุณุงุจ ุงูุญุถูุฑ ุชููุงุฆูุงู (true / false)"],

  // ๐ ุงูุชุญูู ูุงูุชูุงุฑูุฑ
  ["Error_Log_Sheet", "ErrorLog", "ูุฑูุฉ ูุชุณุฌูู ุงูุฃุฎุทุงุก"],
  ["Notification_Sheet", "NotificationLog", "ูุฑูุฉ ุงูุฅุดุนุงุฑุงุช"],
  ["Report_Generation", "true", "ุชูููุฏ ุชูุงุฑูุฑ ุชููุงุฆูุงู (true / false)"],
  ["Report_Format", "PDF", "ุชูุณูู ุงูุชูุงุฑูุฑ (PDF / Excel / HTML)"],
  ["Max_Login_Attempts", "5", "ุงูุญุฏ ุงูุฃูุตู ููุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู"],

  // ๐ ุฅุถุงููุฉ
  ["Default_Password", "Kanant@123", "ูููุฉ ุงููุฑูุฑ ุงูุงูุชุฑุงุถูุฉ ูููุณุชุฎุฏููู ุงูุฌุฏุฏ"],
  ["Theme_Color", "#1E90FF", "ููู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุฆูุณู"],
  ["Support_Contact", "+967-777-123456", "ุฑูู ุฃู ุจุฑูุฏ ุงูุฏุนู ุงูููู"],
  ["Terms_And_Conditions_URL", "https://kanantacademy.com/terms", "ุฑุงุจุท ุงูุดุฑูุท ูุงูุฃุญูุงู"],
  ["Privacy_Policy_URL", "https://kanantacademy.com/privacy", "ุฑุงุจุท ุณูุงุณุฉ ุงูุฎุตูุตูุฉ"],

  // ๐ ุฃูุงู ูุชุณุฌูู ุฏุฎูู
  ["Password_Policy", "min8+upper+number", "ุณูุงุณุฉ ูููุงุช ุงููุฑูุฑ (ุญุฏ ุฃุฏูู 8 ุญุฑููุ ุญุฑู ูุจูุฑุ ุฑูู)"],
  ["Two_Factor_Auth", "true", "ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ"],
  ["Session_Timeout", "30", "ูุฏุฉ ุงูุชูุงุก ุงูุฌูุณุฉ ุจุงูุฏูุงุฆู"],

  // โ๏ธ ุชูุจููุงุช ุฅุถุงููุฉ
  ["Low_Attendance_Alert", "true", "ุชูุจูู ุนูุฏ ุงูุฎูุงุถ ูุณุจุฉ ุงูุญุถูุฑ"],
  ["Overdue_Task_Alert", "true", "ุชูุจูู ุนูุฏ ููุงู ูุชุฃุฎุฑุฉ"],

  // ๐ ุชูุงุฑูุฑ ูุชูุฏูุฉ
  ["Report_Recipients", "admin@kanantacademy.com", "ูุงุฆูุฉ ุจุฑูุฏูุฉ ูุชููู ุงูุชูุงุฑูุฑ"],
  ["Report_Schedule", "weekly", "ุฌุฏูู ุชูููุช ุชูููุฏ ุงูุชูุงุฑูุฑ (daily/weekly/monthly)"],
  ["Enable_Analytics", "true", "ุชูุนูู ุฌูุน ุงูุฅุญุตุงุฆูุงุช ูุงูุฃุฏุงุก"],
  ["Analytics_Report_Sheet", "AnalyticsLog", "ูุฑูุฉ ูุชุฎุฒูู ุจูุงูุงุช ุงูุชุญููู ูุงูุฅุญุตุงุกุงุช"],

  // ๐จ ุชุฎุตูุต ูุงุฌูุฉ ุงููุณุชุฎุฏู
  ["Default_Language_UI", "ar", "ูุบุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุงูุชุฑุงุถูุฉ"],
  ["Enable_Dark_Mode", "false", "ุชูุนูู ุงููุถุน ุงููููู"],
  ["Homepage_Message", "ูุฑุญุจุง ุจู ูู ุฃูุงุฏูููุฉ ูู ุฃูุช!", "ุฑุณุงูุฉ ุชุฑุญูุจ ุนูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ"],
  ["Custom_CSS", "custom_style.css", "ููู CSS ูุฎุตุต ูุชุบููุฑ ุณุชุงูู ุงููุธุงู"],
  ["Custom_JS", "custom_script.js", "ููู JS ูุฎุตุต ูุชุนุฏููุงุช ุงููุธุงู"],

  // ๐ ุงูุฑุจุท ุงูุฎุงุฑุฌู
  ["Integration_Portal_URL", "https://externalportal.com", "ุฑุงุจุท ุชูุงูู ุงูููุตุงุช ุงูุฃุฎุฑู"],
  ["External_API_Endpoints", "api/v1/getData", "ูุงุฆูุฉ ููุงุท ุงูููุงูุฉ ุงูุฎุงุฑุฌูุฉ"],

  // ๐พ ุงููุณุฎ ุงูุงุญุชูุงุทู ูุงูุชุฎุฒูู
  ["Backup_Frequency", "daily", "ุชูุงุชุฑ ุงููุณุฎ ุงูุงุญุชูุงุทู (daily/weekly/monthly)"],
  ["Backup_Location", "DriveFolderID_123456", "ูููุน ุชุฎุฒูู ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ"],
  ["Data_Retention_Days", "365", "ูุฏุฉ ุงูุงุญุชูุงุธ ุจุงูุจูุงูุงุช ูุจู ุงูุฃุฑุดูุฉ"],
  ["FLOATING_WHATSAPP", "967777612552", "ุฒุฑ ูุชุณุงุจ ุงูุนุงุฆู"],
  // ๐ ุฅุนุฏุงุฏุงุช ุงููุบุฉ ุงููุชุนุฏุฏุฉ
  ["Supported_Languages", "ar,en,fr", "ูุงุฆูุฉ ุงููุบุงุช ุงููุฏุนููุฉ ูููุธุงู"], 
  ["FOLDER_ID", "FOLDER_ID", "ูุนุฑู ูุฌูุฏ ุงูุชุฎุฒูู ุงูุฎุงุต ุจุงูุดูุงุฏุงุช "], 
  ["TEMPLATE_ID", "TEMPLATE_ID", "ูุนุฑู ูุงูุจ ุงูุดูุงุฏุฉ"], 
  ["CVP", "CVP.html", "ุฑุงุจุท ุตูุญุฉ ุงูุชุญูู ูู ุงูุดูุงุฏุงุช "] 

];


  var settingsSheet = ss.getSheetByName("ุงูุฅุนุฏุงุฏุงุช");
  if (settingsSheet.getLastRow() === 1) {
    settingsSheet.getRange(2, 1, settingsData.length, 3).setValues(settingsData);
  }


  fillSurahData(); 
  finalReport.push("๐ ูุงุนุฏุฉ ุงูุณูุฑ: ุชู ูุญุต ูุชุนุจุฆุฉ ุจูุงูุงุช 114 ุณูุฑุฉ");
  // 3. ุนุฑุถ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ
  SpreadsheetApp.getUi().alert("๐ ุชูุฑูุฑ ุตูุงูุฉ ุงููุธุงู:\n\n" + finalReport.join("\n"));
}





/**
 * ุฏุงูุฉ ุฌูุจ ุงูุฅุนุฏุงุฏุงุช (ุงููุณุฎุฉ ุงููุญุณูุฉ ูุงูุณุฑูุนุฉ)
 */
function getSetting(key) {
  var ss = getSS();
  var sheet = ss.getSheetByName("ุงูุฅุนุฏุงุฏุงุช");
  if (!sheet) return null;
  
  var data = sheet.getDataRange().getValues();
  for (var i = 1; i < data.length; i++) {
    if (data[i][0] === key) return data[i][1];
  }
  return null;
}

/**
 * ุงูุฏุงูุฉ ุงููุณุคููุฉ ุนู ูุญุต ุงููุฌูุฏุ ุชุฑุชูุจ ุงูุฃุนูุฏุฉุ ูุฅุถุงูุฉ ุงูุจูุงูุงุช ุงููุงูุตุฉ
 */
function createSheetIfNotExist(ss, name, headers) {
  var sheet = ss.getSheetByName(name);
  var status = "";

  if (!sheet) {
    // 1. ุฅูุดุงุก ุงูุดูุช ุฅุฐุง ูู ููู ููุฌูุฏุงู
    sheet = ss.insertSheet(name);
    sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
    formatHeader(sheet);
    status = "๐ ุชู ุงูุฅูุดุงุก ุจูุฌุงุญ";
  } else {
    // 2. ุฅุฐุง ูุงู ููุฌูุฏุงูุ ููุญุต ุงูุฑุคูุณ (ุงูุชุฑุชูุจ ูุงูุฃุณูุงุก)
    var lastCol = Math.max(sheet.getLastColumn(), 1);
    var existingHeaders = sheet.getRange(1, 1, 1, lastCol).getValues()[0];
    
    if (JSON.stringify(existingHeaders) !== JSON.stringify(headers)) {
      var lastRow = sheet.getLastRow();
      if (lastRow > 1) {
        // ุฅุนุงุฏุฉ ุชุฑุชูุจ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูุชุทุงุจู ุงููููู ุงูุฌุฏูุฏ
        var oldData = sheet.getRange(2, 1, lastRow - 1, lastCol).getValues();
        var newData = oldData.map(function(row) {
          return headers.map(function(h) {
            var idx = existingHeaders.indexOf(h);
            return (idx > -1) ? row[idx] : ""; // ูุถุน ูุฑุงุบ ุฅุฐุง ูุงู ุงูุนููุฏ ุฌุฏูุฏุงู
          });
        });
        sheet.clearContents();
        sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
        sheet.getRange(2, 1, newData.length, headers.length).setValues(newData);
      } else {
        // ุฅุฐุง ูุงู ุงูุดูุช ูุญุชูู ุฑุคูุณุงู ููุทุ ูููู ุจุชุญุฏูุซูุง ูุจุงุดุฑุฉ
        sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
      }
      formatHeader(sheet);
      status = "๐ ุชู ุชุตุญูุญ ุงููููู ูุงูุฃุนูุฏุฉ";
    } else {
      status = "โ ูุทุงุจู ููุคูู";
    }
  }

  // ุชุณุฌูู ุงูุนูููุฉ ูู ุณุฌู ุงูุฅุฏุงุฑุฉ (ุงุฎุชูุงุฑู)
  logAdminAction(ss, name, status);
  return status;
}

/**
 * ุชูุณูู ุงูุฑุฃุณ ุจุดูู ุงุญุชุฑุงูู
 */
function formatHeader(sheet) {
  var range = sheet.getRange(1, 1, 1, sheet.getLastColumn());
  range.setBackground("#202124") // ููู ุฏุงูู
       .setFontColor("#ffffff")
       .setFontWeight("bold")
       .setHorizontalAlignment("center");
  sheet.setFrozenRows(1);
}

/**
 * ุชุณุฌูู ุงููุดุงุท
 */
function logAdminAction(ss, sheetName, detail) {
  var logSheet = ss.getSheetByName("ุณุฌู_ุงูุนูููุงุช_ุงูุฅุฏุงุฑูุฉ");
  if (logSheet && sheetName !== "ุณุฌู_ุงูุนูููุงุช_ุงูุฅุฏุงุฑูุฉ") {
    logSheet.appendRow([new Date(), "ูุธุงู ุงูุชุฃุณูุณ", sheetName, detail]);
  }
}

/**
 * ุชุนุจุฆุฉ ุจูุงูุงุช ุงูุณูุฑ
 */
/**
 * ุชุนุจุฆุฉ ุจูุงูุงุช ุงูุณูุฑ ูุงููุฉ (114 ุณูุฑุฉ)
 */
function fillSurahData() {
  var ss = getSS();
  var sheetName = "ูุงุนุฏุฉ ุงูุณูุฑ";
  var headers = ["ููุฏ ุงูุณูุฑุฉ", "ุงุณู ุงูุณูุฑุฉ", "ุนุฏุฏ ุงูุขูุงุช", "ุงููุตุญู"];
  
  // ุงูุชุฃูุฏ ูู ุฅูุดุงุก ุงูุฌุฏูู ูุชูุณูู ุงูุฃุนูุฏุฉ ุฃููุงู
  createSheetIfNotExist(ss, sheetName, headers);
  
  // ุฌูุจ ุงูุฌุฏูู ููุงุฆู (Object) ููุชุนุงูู ูุน ุงูุจูุงูุงุช
  var sheet = ss.getSheetByName(sheetName);

  // ุงููุตูููุฉ ุงููุงููุฉ ูุฌููุน ุณูุฑ ุงููุฑุขู ุงููุฑูู
  var surahs = [
    ["1","ุงููุงุชุญุฉ","7","ููู"], ["2","ุงูุจูุฑุฉ","286","ูุฏูู"], ["3","ุขู ุนูุฑุงู","200","ูุฏูู"], ["4","ุงููุณุงุก","176","ูุฏูู"], ["5","ุงููุงุฆุฏุฉ","120","ูุฏูู"], ["6","ุงูุฃูุนุงู","165","ููู"], ["7","ุงูุฃุนุฑุงู","206","ููู"], ["8","ุงูุฃููุงู","75","ูุฏูู"], ["9","ุงูุชูุจุฉ","129","ูุฏูู"], ["10","ูููุณ","109","ููู"],
    ["11","ููุฏ","123","ููู"], ["12","ููุณู","111","ููู"], ["13","ุงูุฑุนุฏ","43","ูุฏูู"], ["14","ุฅุจุฑุงููู","52","ููู"], ["15","ุงูุญุฌุฑ","99","ููู"], ["16","ุงููุญู","128","ููู"], ["17","ุงูุฅุณุฑุงุก","111","ููู"], ["18","ุงูููู","110","ููู"], ["19","ูุฑูู","98","ููู"], ["20","ุทู","135","ููู"],
    ["21","ุงูุฃูุจูุงุก","112","ููู"], ["22","ุงูุญุฌ","78","ูุฏูู"], ["23","ุงููุคูููู","118","ููู"], ["24","ุงูููุฑ","64","ูุฏูู"], ["25","ุงููุฑูุงู","77","ููู"], ["26","ุงูุดุนุฑุงุก","227","ููู"], ["27","ุงูููู","93","ููู"], ["28","ุงููุตุต","88","ููู"], ["29","ุงูุนููุจูุช","69","ููู"], ["30","ุงูุฑูู","60","ููู"],
    ["31","ูููุงู","34","ููู"], ["32","ุงูุณุฌุฏุฉ","30","ููู"], ["33","ุงูุฃุญุฒุงุจ","73","ูุฏูู"], ["34","ุณุจุฃ","54","ููู"], ["35","ูุงุทุฑ","45","ููู"], ["36","ูุณ","83","ููู"], ["37","ุงูุตุงูุงุช","182","ููู"], ["38","ุต","88","ููู"], ["39","ุงูุฒูุฑ","75","ููู"], ["40","ุบุงูุฑ","85","ููู"],
    ["41","ูุตูุช","54","ููู"], ["42","ุงูุดูุฑู","53","ููู"], ["43","ุงูุฒุฎุฑู","89","ููู"], ["44","ุงูุฏุฎุงู","59","ููู"], ["45","ุงูุฌุงุซูุฉ","37","ููู"], ["46","ุงูุฃุญูุงู","35","ููู"], ["47","ูุญูุฏ","38","ูุฏูู"], ["48","ุงููุชุญ","29","ูุฏูู"], ["49","ุงูุญุฌุฑุงุช","18","ูุฏูู"], ["50","ู","45","ููู"],
    ["51","ุงูุฐุงุฑูุงุช","60","ููู"], ["52","ุงูุทูุฑ","49","ููู"], ["53","ุงููุฌู","62","ููู"], ["54","ุงูููุฑ","55","ููู"], ["55","ุงูุฑุญูู","78","ูุฏูู"], ["56","ุงููุงูุนุฉ","96","ููู"], ["57","ุงูุญุฏูุฏ","29","ูุฏูู"], ["58","ุงููุฌุงุฏูุฉ","22","ูุฏูู"], ["59","ุงูุญุดุฑ","24","ูุฏูู"], ["60","ุงูููุชุญูุฉ","13","ูุฏูู"],
    ["61","ุงูุตู","14","ูุฏูู"], ["62","ุงูุฌูุนุฉ","11","ูุฏูู"], ["63","ุงูููุงูููู","11","ูุฏูู"], ["64","ุงูุชุบุงุจู","18","ูุฏูู"], ["65","ุงูุทูุงู","12","ูุฏูู"], ["66","ุงูุชุญุฑูู","12","ูุฏูู"], ["67","ุงูููู","30","ููู"], ["68","ุงูููู","52","ููู"], ["69","ุงูุญุงูุฉ","52","ููู"], ["70","ุงููุนุงุฑุฌ","44","ููู"],
    ["71","ููุญ","28","ููู"], ["72","ุงูุฌู","28","ููู"], ["73","ุงููุฒูู","20","ููู"], ["74","ุงููุฏุซุฑ","56","ููู"], ["75","ุงูููุงูุฉ","40","ููู"], ["76","ุงูุฅูุณุงู","31","ูุฏูู"], ["77","ุงููุฑุณูุงุช","50","ููู"], ["78","ุงููุจุฃ","40","ููู"], ["79","ุงููุงุฒุนุงุช","46","ููู"], ["80","ุนุจุณ","42","ููู"],
    ["81","ุงูุชูููุฑ","29","ููู"], ["82","ุงูุงููุทุงุฑ","19","ููู"], ["83","ุงููุทูููู","36","ููู"], ["84","ุงูุงูุดูุงู","25","ููู"], ["85","ุงูุจุฑูุฌ","22","ููู"], ["86","ุงูุทุงุฑู","17","ููู"], ["87","ุงูุฃุนูู","19","ููู"], ["88","ุงูุบุงุดูุฉ","26","ููู"], ["89","ุงููุฌุฑ","30","ููู"], ["90","ุงูุจูุฏ","20","ููู"],
    ["91","ุงูุดูุณ","15","ููู"], ["92","ุงูููู","21","ููู"], ["93","ุงูุถุญู","11","ููู"], ["94","ุงูุดุฑุญ","8","ููู"], ["95","ุงูุชูู","8","ููู"], ["96","ุงูุนูู","19","ููู"], ["97","ุงููุฏุฑ","5","ููู"], ["98","ุงูุจููุฉ","8","ูุฏูู"], ["99","ุงูุฒูุฒูุฉ","8","ูุฏูู"], ["100","ุงูุนุงุฏูุงุช","11","ููู"],
    ["101","ุงููุงุฑุนุฉ","11","ููู"], ["102","ุงูุชูุงุซุฑ","8","ููู"], ["103","ุงูุนุตุฑ","3","ููู"], ["104","ุงูููุฒุฉ","9","ููู"], ["105","ุงูููู","5","ููู"], ["106","ูุฑูุด","4","ููู"], ["107","ุงููุงุนูู","7","ููู"], ["108","ุงูููุซุฑ","3","ููู"], ["109","ุงููุงูุฑูู","6","ููู"], ["110","ุงููุตุฑ","3","ูุฏูู"],
    ["111","ุงููุณุฏ","5","ููู"], ["112","ุงูุฅุฎูุงุต","4","ููู"], ["113","ุงูููู","5","ููู"], ["114","ุงููุงุณ","6","ููู"]
  ];

  // ุงูุชุญูู ูู ุฃู ุงูุฌุฏูู ูุงุฑุบ (ูุญุชูู ุงูุฑุฃุณ ููุท) ูุจู ุงููุชุงุจุฉ
  if (sheet.getLastRow() === 1) {
    sheet.getRange(2, 1, surahs.length, 4).setValues(surahs);
  }
}

function onOpen() {
  SpreadsheetApp.getUi().createMenu('๐๏ธ ูุธุงู ุฃูุงุฏูููุฉ ูู ุฃูุช')
      .addItem('๐๏ธ ุชุฃุณูุณ ุงูุฌุฏุงูู', 'setupFullSystem')
      .addItem('๐ ุชุนุจุฆุฉ ุจูุงูุงุช ุงูุณูุฑ', 'fillSurahData')
      .addToUi();
}

